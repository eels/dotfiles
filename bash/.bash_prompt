#!/bin/bash

# ----------------------------------------
#   Author: Liam Howell
#   Description: Bash prompt-only configurations
#
#   1. VARIABLES
#   2. FUNCTIONS
#   3. PROMPTS
# ----------------------------------------

# ----------------------------------------
#   1. VARIABLES
# ----------------------------------------

## Name
NAME="liam"

## Colors
BLACK="\[\033[0;30m\]"
RED="\[\033[0;31m\]"
GREEN="\[\033[0;32m\]"
YELLOW="\[\033[0;33m\]"
BLUE="\[\033[0;34m\]"
WHITE="\[\033[0;37m\]"

# ----------------------------------------
#   2. FUNCTIONS
# ----------------------------------------

function gitprompt() {
  git rev-parse --is-inside-work-tree &>/dev/null || return

  local symbol
  local branch

  symbol=''
  branch="$(git branch --show-current)"

  ## Check for changes that are uncommitted
  if ! eval git diff --quiet --ignore-submodules --cached; then
    symbol+='+'
  fi

  ## Check for changes that are unstaged
  if ! eval git diff-files --quiet --ignore-submodules --; then
    symbol+='!'
  fi

  ## Check for changes that are untracked
  if [ -n "$(git ls-files --others --exclude-standard)" ]; then
    symbol+='?'
  fi

  ## Wrap symbol in square brackets if it isn't empty
  if [ -n "${symbol}" ]; then
    symbol="[${symbol}]"
  fi

  echo -e "${1}${branch}${2} ${symbol}"
}

# ----------------------------------------
#   3. PROMPTS
# ----------------------------------------

## Set default prompt
export PS1="\[\033]0;\w\007\]${GREEN}${NAME} ${WHITE}in ${YELLOW}\w \$(gitprompt \"${WHITE}on ${RED}\" \"${BLUE}\") \n${WHITE}$ ${BLACK}"

## Set continuation prompt
export PS2="${WHITE}âžœ ${BLACK}"
