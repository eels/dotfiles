#!/bin/bash

# ----------------------------------------
#   Author: Liam Howell
#   Description: Bash git configurations
#
#   1. INTERCEPTOR
#   2. FUNCTIONS
# ----------------------------------------

# ----------------------------------------
#   1. INTERCEPTOR
# ----------------------------------------

function __gitinterceptor() {
  if [ $# -eq 0 ] || ! git config --list | grep -q "^alias\\.override-$1"; then
    git "$@"
  else
    git "override-$1" "${@:2}"
  fi
}

alias git="__gitinterceptor"

# ----------------------------------------
#   2. FUNCTIONS
# ----------------------------------------

## Override functionality for `git branch`
function __gitbranch() {
  if [ $# -eq 0 ]; then
    git branch --sort=-committerdate --format='%(HEAD) %(color:yellow)%(refname:short)%(color:reset) - %(contents:subject) %(color:green)(%(committerdate:relative)) [%(authorname)]'
  else
    git branch "$@"
  fi
}

## Override functionality for `git checkout`
function __gitcheckout() {
  if [ $# -eq 0 ]; then
    git checkout @{-1}
  else
    git checkout -b $1 2> /dev/null && git track 2> /dev/null || git checkout $1
  fi
}
